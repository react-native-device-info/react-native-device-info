{"ast":null,"code":"import{canUseDOM}from'fbjs/lib/ExecutionEnvironment';import debounce from'debounce';import findNodeHandle from\"../../exports/findNodeHandle\";var emptyObject={};var registry={};var id=1;var guid=function guid(){return\"r-\"+id++;};var resizeObserver;if(canUseDOM){if(typeof window.ResizeObserver!=='undefined'){resizeObserver=new window.ResizeObserver(function(entries){entries.forEach(function(_ref){var target=_ref.target;var instance=registry[target._layoutId];instance&&instance._handleLayout();});});}else{if((process&&process.env&&process.env.NODE_ENV||\"production\")!=='production'&&(process&&process.env&&process.env.NODE_ENV||\"production\")!=='test'){console.warn('onLayout relies on ResizeObserver which is not supported by your browser. '+'Please include a polyfill, e.g., https://github.com/que-etc/resize-observer-polyfill. '+'Falling back to window.onresize.');}var triggerAll=function triggerAll(){Object.keys(registry).forEach(function(key){var instance=registry[key];instance._handleLayout();});};window.addEventListener('resize',debounce(triggerAll,16),false);}}var observe=function observe(instance){var id=guid();registry[id]=instance;if(resizeObserver){var node=findNodeHandle(instance);if(node){node._layoutId=id;resizeObserver.observe(node);}}else{instance._layoutId=id;instance._handleLayout();}};var unobserve=function unobserve(instance){if(resizeObserver){var node=findNodeHandle(instance);if(node){delete registry[node._layoutId];delete node._layoutId;resizeObserver.unobserve(node);}}else{delete registry[instance._layoutId];delete instance._layoutId;}};var safeOverride=function safeOverride(original,next){if(original){return function prototypeOverride(){original.call(this,arguments);next.call(this,arguments);};}return next;};var applyLayout=function applyLayout(Component){var componentDidMount=Component.prototype.componentDidMount;var componentDidUpdate=Component.prototype.componentDidUpdate;var componentWillUnmount=Component.prototype.componentWillUnmount;Component.prototype.componentDidMount=safeOverride(componentDidMount,function componentDidMount(){this._layoutState=emptyObject;this._isMounted=true;if(this.props.onLayout){observe(this);}});Component.prototype.componentDidUpdate=safeOverride(componentDidUpdate,function componentDidUpdate(prevProps){if(this.props.onLayout&&!prevProps.onLayout){observe(this);}else if(!this.props.onLayout&&prevProps.onLayout){unobserve(this);}});Component.prototype.componentWillUnmount=safeOverride(componentWillUnmount,function componentWillUnmount(){this._isMounted=false;if(this.props.onLayout){unobserve(this);}});Component.prototype._handleLayout=function(){var _this=this;var layout=this._layoutState;var onLayout=this.props.onLayout;if(onLayout){this.measure(function(x,y,width,height){if(_this._isMounted){if(layout.x!==x||layout.y!==y||layout.width!==width||layout.height!==height){_this._layoutState={x:x,y:y,width:width,height:height};var nativeEvent={layout:_this._layoutState};Object.defineProperty(nativeEvent,'target',{enumerable:true,get:function get(){return findNodeHandle(_this);}});onLayout({nativeEvent:nativeEvent,timeStamp:Date.now()});}}});}};return Component;};export default applyLayout;","map":{"version":3,"sources":["/Users/robertherber/code/react-native-device-info/example-web/node_modules/react-native-web/dist/modules/applyLayout/index.js"],"names":["canUseDOM","debounce","findNodeHandle","emptyObject","registry","id","guid","resizeObserver","window","ResizeObserver","entries","forEach","_ref","target","instance","_layoutId","_handleLayout","console","warn","triggerAll","Object","keys","key","addEventListener","observe","node","unobserve","safeOverride","original","next","prototypeOverride","call","arguments","applyLayout","Component","componentDidMount","prototype","componentDidUpdate","componentWillUnmount","_layoutState","_isMounted","props","onLayout","prevProps","_this","layout","measure","x","y","width","height","nativeEvent","defineProperty","enumerable","get","timeStamp","Date","now"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Nicolas Gallagher.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n */\nimport { canUseDOM } from 'fbjs/lib/ExecutionEnvironment';\nimport debounce from 'debounce';\nimport findNodeHandle from '../../exports/findNodeHandle';\nvar emptyObject = {};\nvar registry = {};\nvar id = 1;\n\nvar guid = function guid() {\n  return \"r-\" + id++;\n};\n\nvar resizeObserver;\n\nif (canUseDOM) {\n  if (typeof window.ResizeObserver !== 'undefined') {\n    resizeObserver = new window.ResizeObserver(function (entries) {\n      entries.forEach(function (_ref) {\n        var target = _ref.target;\n        var instance = registry[target._layoutId];\n        instance && instance._handleLayout();\n      });\n    });\n  } else {\n    if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n      console.warn('onLayout relies on ResizeObserver which is not supported by your browser. ' + 'Please include a polyfill, e.g., https://github.com/que-etc/resize-observer-polyfill. ' + 'Falling back to window.onresize.');\n    }\n\n    var triggerAll = function triggerAll() {\n      Object.keys(registry).forEach(function (key) {\n        var instance = registry[key];\n\n        instance._handleLayout();\n      });\n    };\n\n    window.addEventListener('resize', debounce(triggerAll, 16), false);\n  }\n}\n\nvar observe = function observe(instance) {\n  var id = guid();\n  registry[id] = instance;\n\n  if (resizeObserver) {\n    var node = findNodeHandle(instance);\n\n    if (node) {\n      node._layoutId = id;\n      resizeObserver.observe(node);\n    }\n  } else {\n    instance._layoutId = id;\n\n    instance._handleLayout();\n  }\n};\n\nvar unobserve = function unobserve(instance) {\n  if (resizeObserver) {\n    var node = findNodeHandle(instance);\n\n    if (node) {\n      delete registry[node._layoutId];\n      delete node._layoutId;\n      resizeObserver.unobserve(node);\n    }\n  } else {\n    delete registry[instance._layoutId];\n    delete instance._layoutId;\n  }\n};\n\nvar safeOverride = function safeOverride(original, next) {\n  if (original) {\n    return function prototypeOverride() {\n      /* eslint-disable prefer-rest-params */\n      original.call(this, arguments);\n      next.call(this, arguments);\n      /* eslint-enable prefer-rest-params */\n    };\n  }\n\n  return next;\n};\n\nvar applyLayout = function applyLayout(Component) {\n  var componentDidMount = Component.prototype.componentDidMount;\n  var componentDidUpdate = Component.prototype.componentDidUpdate;\n  var componentWillUnmount = Component.prototype.componentWillUnmount;\n  Component.prototype.componentDidMount = safeOverride(componentDidMount, function componentDidMount() {\n    this._layoutState = emptyObject;\n    this._isMounted = true;\n\n    if (this.props.onLayout) {\n      observe(this);\n    }\n  });\n  Component.prototype.componentDidUpdate = safeOverride(componentDidUpdate, function componentDidUpdate(prevProps) {\n    if (this.props.onLayout && !prevProps.onLayout) {\n      observe(this);\n    } else if (!this.props.onLayout && prevProps.onLayout) {\n      unobserve(this);\n    }\n  });\n  Component.prototype.componentWillUnmount = safeOverride(componentWillUnmount, function componentWillUnmount() {\n    this._isMounted = false;\n\n    if (this.props.onLayout) {\n      unobserve(this);\n    }\n  });\n\n  Component.prototype._handleLayout = function () {\n    var _this = this;\n\n    var layout = this._layoutState;\n    var onLayout = this.props.onLayout;\n\n    if (onLayout) {\n      this.measure(function (x, y, width, height) {\n        if (_this._isMounted) {\n          if (layout.x !== x || layout.y !== y || layout.width !== width || layout.height !== height) {\n            _this._layoutState = {\n              x: x,\n              y: y,\n              width: width,\n              height: height\n            };\n            var nativeEvent = {\n              layout: _this._layoutState\n            };\n            Object.defineProperty(nativeEvent, 'target', {\n              enumerable: true,\n              get: function get() {\n                return findNodeHandle(_this);\n              }\n            });\n            onLayout({\n              nativeEvent: nativeEvent,\n              timeStamp: Date.now()\n            });\n          }\n        }\n      });\n    }\n  };\n\n  return Component;\n};\n\nexport default applyLayout;"]},"metadata":{},"sourceType":"module"}